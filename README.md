# AI Chat - Flutter приложение

Чат-приложение на Flutter, использующее API OpenRouter для взаимодействия с различными моделями искусственного интеллекта.

## Поддержка платформ

- **Desktop**: Windows, Linux, macOS
- **Mobile**: Android, iOS

Подробные инструкции для разработчиков: [readme_develop.md](readme_develop.md)

## Быстрый старт

### Требования
- Flutter SDK 3.0.0+
- Git

### Установка

1. **Установите Flutter SDK**: https://docs.flutter.dev/get-started/install
2. **Клонируйте проект**:
   ```bash
   git clone <repository-url>
   cd AI_chat_flutter
   ```
3. **Установите зависимости**:
   ```bash
   flutter pub get
   ```
4. **Создайте файл `.env`**:
   ```env
   OPENROUTER_API_KEY=ваш_api_ключ
   OPENROUTER_BASE_URL=https://openrouter.ai/api/v1
   MAX_TOKENS=1000
   TEMPERATURE=0.7
   ```
5. **Запустите приложение**:
   ```bash
   flutter run -d windows  # или android, ios, linux, macos
   ```

## Основные зависимости

- **http** - HTTP запросы к API
- **sqflite** / **sqflite_common_ffi** - База данных SQLite
- **flutter_dotenv** - Переменные окружения
- **logger** - Логирование
- **shared_preferences** / **flutter_secure_storage** - Хранилище данных
- **path_provider** - Пути к директориям
- **intl** - Форматирование дат
- **crypto** - Криптография
- **fl_chart** - Графики и визуализация данных

## Основные возможности

- **Чат** с более чем 339 моделями через OpenRouter API
- **Статистика** использования моделей с фильтрацией и сортировкой
- **Расходы** с визуализацией графиков и сравнением периодов
- **Настройки** провайдера и API ключей
- Сохранение истории в SQLite
- Экспорт данных в JSON и CSV
- Аналитика использования моделей
- Безопасное хранение API ключей
- Адаптивный дизайн для всех платформ (мобильные, планшеты, десктопы)
- Плавные анимации переходов между страницами

## Архитектура приложения

Приложение использует многостраничную архитектуру с навигацией через `HomeScreen`:

- **ChatScreen** - основной экран чата с историей сообщений
- **StatisticsScreen** - статистика использования моделей и метрики производительности
- **ExpensesScreen** - график расходов с фильтрацией и сравнением периодов
- **SettingsScreen** - настройки провайдера и API ключей

Навигация адаптивна:
- **Мобильные устройства**: `BottomNavigationBar` внизу экрана
- **Десктопные платформы**: `NavigationRail` слева экрана

## Структура проекта

```
lib/
├── api/                    # OpenRouter API клиент
├── auth/                   # Аутентификация и управление ключами
├── config/                 # Конфигурация и переменные окружения
├── models/                 # Модели данных (сообщения, аналитика, модели)
├── navigation/             # Роутинг и навигация между страницами
│   └── app_router.dart     # Роутер с кастомными переходами
├── screens/                # Экраны приложения
│   ├── home_screen.dart    # Главный экран с навигацией
│   ├── chat_screen.dart    # Экран чата
│   ├── statistics_screen.dart  # Экран статистики
│   ├── expenses_screen.dart   # Экран расходов
│   └── settings_screen.dart   # Экран настроек
├── ui/                     # UI компоненты и стили
│   ├── components/         # Переиспользуемые компоненты
│   │   ├── animated_button.dart           # Анимированные кнопки
│   │   ├── animated_loading_indicator.dart # Индикаторы загрузки
│   │   ├── message_bubble.dart            # Пузырьки сообщений
│   │   └── model_selector.dart             # Селектор моделей
│   ├── transitions/        # Анимации переходов
│   │   └── page_transitions.dart          # Кастомные переходы
│   ├── login/              # Экран входа
│   ├── styles.dart         # Стили и адаптивные методы
│   └── theme.dart          # Тема приложения
├── utils/                  # Утилиты
│   ├── analytics.dart      # Аналитика использования
│   ├── cache.dart          # Кэш сообщений
│   ├── database/           # Работа с БД
│   ├── expenses_calculator.dart  # Калькулятор расходов
│   ├── logger.dart        # Логирование
│   ├── monitor.dart       # Мониторинг производительности
│   └── platform.dart      # Определение платформы
├── app.dart                # Основной класс приложения
└── main.dart               # Точка входа
```

## Разработка

```bash
flutter run           # Запуск
flutter test          # Тесты
flutter analyze       # Анализ кода
flutter build windows --release  # Сборка
```

## Особенности реализации

### Навигация
- Используется многостраничная архитектура с `HomeScreen` как контейнером
- Плавные переходы между страницами через кастомные `PageTransitions`
- Адаптивная навигация: `BottomNavigationBar` для мобильных, `NavigationRail` для десктопа

### Анимации
- Все переходы используют оптимизированные кривые анимации (easeOutCubic)
- Анимированные индикаторы загрузки с пульсирующим эффектом
- Плавное переключение между страницами через `AnimatedSwitcher`

### Производительность
- Кэширование страниц для сохранения состояния
- Оптимизированные запросы к БД с фильтрацией на уровне SQL
- Ограничение количества обрабатываемых данных для графиков

### Адаптивность
- Трехуровневая система размеров экрана: small (мобильные), medium (планшеты), large (десктопы)
- Адаптивные отступы и размеры элементов
- Оптимизированные layout'ы для разных размеров экранов

## Аутентификация

Приложение использует систему аутентификации с поддержкой API ключей OpenRouter и VSEGPT.

**Подробное руководство**: [AUTH_GUIDE.md](AUTH_GUIDE.md)

**Краткая информация:**
- Первый вход: введите API ключ (OpenRouter: `sk-or-v1-...` или VSEGPT: `sk-or-vv-...`)
- Повторный вход: используйте PIN код (4 цифры) или обновите API ключ
- Сброс ключа: удаляет все данные аутентификации для нового входа

## Поддержка

При проблемах:
1. `flutter pub get` - установка зависимостей
2. `flutter doctor` - проверка окружения
3. Проверьте логи в `logs/`
4. См. [AUTH_GUIDE.md](AUTH_GUIDE.md) для вопросов по аутентификации